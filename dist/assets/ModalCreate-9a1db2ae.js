import{i as M,b as _,r as v,j as e,e as r}from"./index-21aef9be.js";import{c as A,a as d,b as N,d as P,u as R,o as z}from"./index.esm-89d4b198.js";import{S as D}from"./sweetalert2.all-3c97b21a.js";import{D as B}from"./index.esm-47ae80ff.js";const L="https://fastapi-gv342xsbja-tl.a.run.app/departamentos",I=async t=>{const c={department_id:t.deptoId,name:t.nombre,description:t.descripcion,baths:t.banos,rooms:t.habitaciones,beds:t.camas,daily_rate:t.tarifa,active:t.active,num_host:t.huespedes},x=new URLSearchParams(c).toString(),m=`${L}?${x}`,n={method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${t.access_token}`}};try{const l=await fetch(m,n);if(!l.ok){const s=await l.text();throw new Error(`API Error (${l.status}): ${s}`)}return await l.json()}catch(l){throw new Error("API Error: "+l.message||"Error al actualizar el departamento")}};function S(t){if(!t)return"$0";t=t.toString();const c=t.replace(/\$|\.|,/g,"");return`$${new Intl.NumberFormat().format(c)}`}const $=A({nombre:d().required("Nombre requerido").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),numero:d().required("Número requerido").min(3,"Mín. 3 dígitos").max(50,"Máx. 50 dígitos"),region:d(),comuna:d(),tipo:d(),tarifa:d().required("La tarifa es requerido").matches(/^\$\d{1,3}(\.\d{3})*$/,"Formato de tarifa inválido").test("is-valid-number","La tarifa debe ser un número válido",t=>{const c=parseFloat(t.replace(/[^\d]/g,""));return!isNaN(c)&&c>0&&c<=999999999}),direccion:d().required("Calle requerida").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),descripcion:d().required("Descripción requerida").min(10,"Mín. 10 letras").max(250,"Máx. 250 letras"),banos:N().typeError("Baños debe ser un número").required("Baños requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),habitaciones:N().typeError("Habitaciones debe ser un número").required("Habitaciones requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),camas:N().typeError("Camas debe ser un número").required("Camas requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(20,"Máx. 20"),huespedes:N().typeError("Huespedes debe ser un número").required("Huéspedes requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(30,"Máx. 20"),active:P().required("Estado requerido")}),F=({onClose:t,showModal:c,deptoId:x})=>{const{user:m}=_(),{register:n,handleSubmit:l,formState:{errors:s},getValues:g,setValue:p,reset:u}=R({resolver:z($)}),C=async b=>{try{const y={access_token:m.access_token,deptoId:x,nombre:b.nombre,descripcion:b.descripcion,banos:b.banos,habitaciones:b.habitaciones,camas:b.camas,tarifa:parseInt(b.tarifa.replace(/\$|\.|,/g,"")),active:b.active?"S":"N",huespedes:b.huespedes};await I(y),t(),u(),D.fire({icon:"success",title:"¡Departamento actualizado!",text:"El departamento se ha actualizado correctamente",confirmButtonText:"Ok"})}catch(y){t(),D.fire({icon:"error",title:"Error al actualizar departamento",text:y,confirmButtonText:"Ok"})}},a=`https://fastapi-gv342xsbja-tl.a.run.app/departamentos/${x}`,[i,E]=v.useState(null);v.useEffect(()=>{x&&fetch(a,{method:"GET"}).then(y=>y.json()).then(y=>{E(y)}).catch(y=>console.log(y))},[x,a]),v.useEffect(()=>{i&&(p("nombre",i==null?void 0:i.NOMBRE),p("numero",i==null?void 0:i.NUMERO),p("region",i==null?void 0:i.NOMBRE_REGION),p("tarifa",S(i==null?void 0:i.TARIFA_DIARIA)),p("comuna",i==null?void 0:i.NOMBRE_COMUNA),p("direccion",i==null?void 0:i.DIRECCION),p("descripcion",i==null?void 0:i.DESCRIPCION),p("banos",i==null?void 0:i.BANOS),p("habitaciones",i==null?void 0:i.DORMITORIOS),p("camas",i==null?void 0:i.CAMAS),p("huespedes",i==null?void 0:i.MAX_HUESPEDES),p("active",(i==null?void 0:i.ACTIVO)==="S"),p("tipo",i==null?void 0:i.TIPO))},[i,p]);const O=b=>{console.log(b.target.value);const y=S(b.target.value);p("tarifa",y)};return e.jsxs(r.Dialog,{open:c,"aria-labelledby":"modalActualizar",size:"xl",className:"max-w-full max-h-screen py-2  overflow-y-scroll",children:[e.jsxs(r.DialogHeader,{className:"border-b-2 border-gray-300 flex justify-between items-start p-5",children:[e.jsxs("span",{className:"text-2xl tracking-tight font-extrabold text-gray-900",children:["Editar Propiedad  ",e.jsxs("span",{className:"font-normal",children:[" - ",i==null?void 0:i.NOMBRE]})]}),e.jsx(r.IconButton,{color:"blue-gray",size:"sm",variant:"text",onClick:()=>{u(),t()},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:l(C),children:[e.jsxs(r.DialogBody,{children:[e.jsx(r.Typography,{children:"Datos de la propiedad"}),e.jsxs("div",{className:"grid grid-cols-2  gap-6 my-12 border-b-4 pb-12 border-b-blue-200",children:[e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{type:"text",name:"nombre",color:"blue",label:"Nombre",size:"md",...n("nombre"),error:!!s.nombre,success:!s.nombre&&g("nombre")}),s.nombre&&e.jsx("div",{className:"absolute left-0   bg-red-500 text-white text-xs mt-1 rounded-lg  px-2",children:s.nombre.message})]}),e.jsxs("div",{className:"flex  justify-center items-center gap-11",children:[e.jsx("div",{className:"relative bg-gray-100  w-full",children:e.jsx(r.Input,{color:"blue",label:"Número",name:"numero",size:"md",...n("numero"),type:"text",readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100 w-full",children:e.jsx(r.Input,{color:"blue",label:"Tipo de Propiedad",size:"md",name:"tipo",...n("tipo"),readOnly:!0})})]}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Región",size:"md",name:"region",...n("region"),readOnly:!0})}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Tarifa Diaria",size:"md",name:"tarifa",...n("tarifa"),onChange:b=>O(b),error:!!s.tarifa,success:!s.tarifa&&g("tarifa"),type:"text"}),s.tarifa&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.tarifa.message})]}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Comuna",size:"md",name:"Comuna",...n("comuna"),readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Dirección",size:"md",name:"direccion",...n("direccion"),type:"text",readOnly:!0})}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Textarea,{color:"blue",label:"Descripción",size:"md",name:"descripcion",...n("descripcion"),type:"text",error:!!s.descripcion,success:!s.descripcion&&g("descripcion")}),s.descripcion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.descripcion.message})]}),e.jsxs("div",{className:"grid w-full grid-cols-1 md:grid-cols-2  gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 w-full h-full gap-2",children:[e.jsx("img",{src:"https://images.pexels.com/photos/2635835/pexels-photo-2635835.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"row-span-1  rounded-l-lg w-full h-full",alt:"prod1"}),e.jsx("img",{src:"https://images.pexels.com/photos/161124/abbaye-de-senanque-monastery-abbey-notre-dame-de-senanque-161124.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"prod2",className:" w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod3",className:"  rounded-l-lg w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod4",className:" w-full h-full"})]}),e.jsx("div",{className:"flex justify-center w-full h-full",children:e.jsx("img",{src:"https://images.pexels.com/photos/7129137/pexels-photo-7129137.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"w-full  rounded-r-lg",alt:"prod5"})})]})]}),e.jsx(r.Typography,{className:"mb-6",children:"Datos del Departamento"}),e.jsxs("div",{className:"grid grid-cols-4  gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Cantidad de Baños",size:"md",...n("banos"),type:"number",name:"banos",error:!!s.banos,success:!s.banos&&g("banos")}),s.banos&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.banos.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{name:"habitaciones",color:"blue",label:"Cantidad de Habitaciones",size:"md",...n("habitaciones"),type:"number",error:!!s.habitaciones,success:!s.habitaciones&&g("habitaciones")}),s.habitaciones&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.habitaciones.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{name:"camas",color:"blue",label:"Cantidad de Camas",size:"md",...n("camas"),type:"number",error:!!s.camas,success:!s.camas&&g("camas")}),s.camas&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.camas.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Cantidad de Huespedes",size:"md",...n("huespedes"),type:"number",name:"huespedes",error:!!s.huespedes,success:!s.huespedes&&g("huespedes")}),s.huespedes&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:s.huespedes.message})]})]}),e.jsx("div",{className:"flex items-center justify-center my-6 ",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(r.Checkbox,{color:"blue",size:"sm",name:"active",...n("active")}),"Habilitar departamento"]})})]}),e.jsxs(r.DialogFooter,{className:"p-2 border-t-2 border-gray-100 gap-4",children:[e.jsx("button",{onClick:()=>{u(),t()},type:"button",className:"text-gray-500 bg-white hover:bg-red-100 focus:ring-4 focus:ring-gray-300 rounded-lg border border-gray-200 text-sm font-semibold px-5 py-2.5 hover:text-gray-900 focus:outline-none focus:z-10",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"text-white   bg-blue-500 hover:bg-blue-100 focus:ring-4 focus:ring-blue-300 rounded-lg border border-blue-200 text-sm font-semibold px-5 py-2.5 hover:text-blue-900 focus:outline-none focus:z-10",children:"Actualizar departamento"})]})]})]})};F.propTypes={onClose:M.func.isRequired,showModal:M.bool.isRequired,deptoId:M.number};const H=A({nombre:d().required("Nombre requerido").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),numero:d().required("Número requerido").min(3,"Mín. 3 dígitos").max(50,"Máx. 50 dígitos"),region:d(),comuna:d(),tipo:d(),tarifa:d().required("La tarifa es requerido").matches(/^\$\d{1,3}(\.\d{3})*$/,"Formato de tarifa inválido").test("is-valid-number","La tarifa debe ser un número válido",t=>{const c=parseFloat(t.replace(/[^\d]/g,""));return!isNaN(c)&&c>0&&c<=999999999}),direccion:d().required("Calle requerida").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),descripcion:d().required("Descripción requerida").min(10,"Mín. 10 letras").max(250,"Máx. 250 letras"),banos:N().typeError("Baños debe ser un número").required("Baños requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),habitaciones:N().typeError("Habitaciones debe ser un número").required("Habitaciones requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),camas:N().typeError("Camas debe ser un número").required("Camas requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(20,"Máx. 20"),huespedes:N().typeError("Huespedes debe ser un número").required("Huéspedes requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(20,"Máx. 20"),active:P().required("Estado requerido")}),V=({onClose:t,showModal:c,deptoId:x})=>{const{register:m,setValue:n}=R({resolver:z(H)}),l=`https://fastapi-gv342xsbja-tl.a.run.app/departamentos/${x}`,[s,g]=v.useState(null);return v.useEffect(()=>{x&&fetch(l,{method:"GET"}).then(u=>u.json()).then(u=>{g(u)}).catch(u=>console.log(u))},[x,l]),v.useEffect(()=>{s&&(n("nombre",s==null?void 0:s.NOMBRE),n("numero",s==null?void 0:s.NUMERO),n("region",s==null?void 0:s.NOMBRE_REGION),n("tarifa",S(s==null?void 0:s.TARIFA_DIARIA)),n("comuna",s==null?void 0:s.NOMBRE_COMUNA),n("direccion",s==null?void 0:s.DIRECCION),n("descripcion",s==null?void 0:s.DESCRIPCION),n("banos",s==null?void 0:s.BANOS),n("habitaciones",s==null?void 0:s.DORMITORIOS),n("camas",s==null?void 0:s.CAMAS),n("huespedes",s==null?void 0:s.MAX_HUESPEDES),n("active",(s==null?void 0:s.ACTIVO)==="S"),n("tipo",s==null?void 0:s.TIPO))},[s,n]),e.jsxs(r.Dialog,{open:c,"aria-labelledby":"modalActualizar",size:"xl",className:"max-w-full max-h-screen py-2  overflow-y-scroll",children:[e.jsxs(r.DialogHeader,{className:"border-b-2 border-gray-300 flex justify-between items-start p-5",children:[e.jsxs("span",{className:"text-2xl tracking-tight font-extrabold text-gray-900",children:["Editar Propiedad  ",e.jsxs("span",{className:"font-normal",children:[" - ",s==null?void 0:s.NOMBRE]})]}),e.jsx(r.IconButton,{color:"blue-gray",size:"sm",variant:"text",onClick:()=>{t()},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{children:[e.jsxs(r.DialogBody,{children:[e.jsx(r.Typography,{children:"Datos de la propiedad"}),e.jsxs("div",{className:"grid grid-cols-2  gap-6 my-12 border-b-4 pb-12 border-b-blue-200",children:[e.jsx("div",{className:"relative bg-gray-100 ",children:e.jsx(r.Input,{type:"text",name:"nombre",color:"blue",label:"Nombre",size:"md",readOnly:!0,...m("nombre")})}),e.jsxs("div",{className:"flex  justify-center items-center gap-11",children:[e.jsx("div",{className:"relative bg-gray-100  w-full",children:e.jsx(r.Input,{color:"blue",label:"Número",name:"numero",size:"md",...m("numero"),type:"text",readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100 w-full",children:e.jsx(r.Input,{color:"blue",label:"Tipo de Propiedad",size:"md",name:"tipo",...m("tipo"),readOnly:!0})})]}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Región",size:"md",name:"region",...m("region"),readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Tarifa Diaria",size:"md",name:"tarifa",...m("tarifa"),type:"text",readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Comuna",size:"md",name:"Comuna",...m("comuna"),readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-100",children:e.jsx(r.Input,{color:"blue",label:"Dirección",size:"md",name:"direccion",...m("direccion"),type:"text",readOnly:!0})}),e.jsx("div",{className:"relative",children:e.jsx(r.Textarea,{style:{backgroundColor:"#f5f5f5"},color:"blue",label:"Descripción",size:"md",name:"descripcion",...m("descripcion"),type:"text",readOnly:!0})}),e.jsxs("div",{className:"grid w-full grid-cols-1 md:grid-cols-2  gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 w-full h-full gap-2",children:[e.jsx("img",{src:"https://images.pexels.com/photos/2635835/pexels-photo-2635835.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"row-span-1  rounded-l-lg w-full h-full",alt:"prod1"}),e.jsx("img",{src:"https://images.pexels.com/photos/161124/abbaye-de-senanque-monastery-abbey-notre-dame-de-senanque-161124.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"prod2",className:" w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod3",className:"  rounded-l-lg w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod4",className:" w-full h-full"})]}),e.jsx("div",{className:"flex justify-center w-full h-full",children:e.jsx("img",{src:"https://images.pexels.com/photos/7129137/pexels-photo-7129137.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"w-full  rounded-r-lg",alt:"prod5"})})]})]}),e.jsx(r.Typography,{className:"mb-6",children:"Datos del Departamento"}),e.jsxs("div",{className:"grid grid-cols-4  gap-6",children:[e.jsx("div",{className:"relative bg-gray-50",children:e.jsx(r.Input,{color:"blue",label:"Cantidad de Baños",size:"md",...m("banos"),type:"number",name:"banos",readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-50",children:e.jsx(r.Input,{name:"habitaciones",color:"blue",label:"Cantidad de Habitaciones",size:"md",...m("habitaciones"),type:"number",max:10,min:1,readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-50",children:e.jsx(r.Input,{name:"camas",color:"blue",label:"Cantidad de Camas",size:"md",...m("camas"),max:20,min:1,type:"number",readOnly:!0})}),e.jsx("div",{className:"relative bg-gray-50",children:e.jsx(r.Input,{color:"blue",label:"Cantidad de Huespedes",size:"md",max:20,min:1,...m("huespedes"),type:"number",name:"huespedes",readOnly:!0})})]}),e.jsx("div",{className:"flex items-center justify-center my-6 ",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(r.Checkbox,{color:"blue",size:"sm",name:"active",...m("active"),disabled:!0}),"Habilitar departamento"]})})]}),e.jsx(r.DialogFooter,{className:"p-2 border-t-2 border-gray-100 gap-4",children:e.jsx("button",{onClick:()=>{t()},type:"button",className:"text-white bg-gray-900 hover:bg-gray-300 focus:ring-4 focus:ring-gray-300 rounded-lg border border-gray-200 text-sm font-semibold px-5 py-2.5 hover:text-gray-900 focus:outline-none focus:z-10",children:"Cerrar Ventana"})})]})]})};V.propTypes={onClose:M.func.isRequired,showModal:M.bool.isRequired,deptoId:M.number};const U="https://fastapi-gv342xsbja-tl.a.run.app/actualizar_departamento",G=async t=>{const c={tipoMantencion:t.tipoMantencion,encargado:t.encargado,startDate:t.startDate,endDate:t.endDate},x=new URLSearchParams(c).toString(),m=`${U}?${x}`,n={method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${t.access_token}`}};try{const l=await fetch(m,n);if(!l.ok){const s=await l.text();throw new Error(`API Error (${l.status}): ${s}`)}return await l.json()}catch(l){throw new Error("API Error: "+l.message||"Error al asignar mantencion")}},K=A({tipoMantencion:d().required(),encargado:d().required("Encargado requerido").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),descripcion:d().required("Descripción requerida").min(10,"Mín. 10 letras").max(250,"Máx. 250 letras")}),W=({onClose:t,showModal:c,deptoId:x})=>{const{user:m}=_(),[n,l]=v.useState(""),[s,g]=v.useState([]),[p,u]=v.useState({startDate:null,endDate:null}),C=`https://fastapi-gv342xsbja-tl.a.run.app/departamentos/${x}`,[a,i]=v.useState(null),E=new Date,O=new Date;O.setFullYear(E.getFullYear()+1);const{register:b,handleSubmit:y,formState:{errors:f},setValue:k,getValues:q,reset:T}=R({resolver:z(K)}),o=async w=>{try{const h={access_token:m.access_token,tipoMantencion:w.tipoMantencion,encargado:w.encargado,startDate:p.startDate,endDate:p.endDate};await G(h),T(),t(),u(null),D.fire({icon:"success",title:"Asignacion de Mantención",text:"La mantención se ha asignado correctamente",confirmButtonText:"Ok"})}catch(h){t(),D.fire({icon:"error",title:"Error al asignar Mantención",text:h,confirmButtonText:"Ok"})}},j=w=>{u(w)};return v.useEffect(()=>{x&&fetch(C,{method:"GET"}).then(h=>h.json()).then(h=>{i(h)}).catch(h=>console.log(h))},[x,C]),v.useEffect(()=>{if(a&&a.DIAS_RESERVADOS){const w=a.DIAS_RESERVADOS.map(h=>({startDate:h.STARTDATE,endDate:h.ENDDATE}));g(w)}else g([])},[a]),e.jsxs(r.Dialog,{open:c,"aria-labelledby":"modalRegistro",size:"xs",children:[e.jsxs(r.DialogHeader,{className:"border-b-2 border-gray-300 flex justify-between items-start p-5",children:[e.jsx("span",{className:"text-2xl tracking-tight font-extrabold text-gray-900",children:"Mantención de Propiedad"}),e.jsx(r.IconButton,{color:"blue-gray",size:"sm",variant:"text",onClick:()=>{T(),u(null),t()},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:y(o),children:[e.jsxs(r.DialogBody,{children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(r.Typography,{className:"-mb-2 mr-5",variant:"h5",children:"Matención de Nombre de propiedad"})}),e.jsxs("div",{className:"flex items-center justify-between gap-6 mt-12 mb-6 ",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsxs(r.Select,{color:"blue",label:"Tipo de Mantenimiento",size:"md",value:n,onChange:w=>{l(w),k("tipoMantencion",w)},error:!!f.tipoMantencion,success:!!(!f.tipoMantencion&&q("tipoMantencion")),children:[e.jsx(r.Option,{value:"1",children:"Mantenimiento Preventivo"}),e.jsx(r.Option,{value:"2",children:"Mantenimiento Correctivo"}),e.jsx(r.Option,{value:"3",children:"Mantenimiento Cosmético"}),e.jsx(r.Option,{value:"4",children:"Mantenimiento Emergencia"}),e.jsx(r.Option,{value:"5",children:"Mantenimiento Temporada"}),e.jsx(r.Option,{value:"6",children:"Mantenimiento Seguridad"}),e.jsx(r.Option,{value:"7",children:"Mantenimiento Legal"})]}),f.tipoMantencion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:f.tipoMantencion.message})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx(r.Input,{color:"blue",type:"text",label:"Encargado",size:"md",...b("encargado"),max:50,min:3,error:!!f.encargado,success:!!(!f.encargado&&q("encargado"))}),f.encargado&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:f.encargado.message})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Textarea,{color:"blue",label:"Descripción",size:"md",name:"descripcion",...b("descripcion"),max:250,min:10,type:"text",error:f.descripcion?f.descripcion.message:void 0,success:!f.descripcion&&q("descripcion")}),f.descripcion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:f.descripcion.message})]}),e.jsxs("div",{className:"bg-blue-100/50 p-2 rounded-lg my-6 flex flex-col items-center w-80 mx-auto",children:[e.jsx(r.Typography,{className:"my-2 font-medium",color:"black",children:"Fechas de Mantención"}),e.jsx(B,{classNames:"text-center",useRange:!1,value:p,readOnly:!0,onChange:j,minDate:E,maxDate:O,primaryColor:"blue",disabledDates:s})]})]}),e.jsxs(r.DialogFooter,{className:"p-2 border-t-2 border-gray-100 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{T(),u(null),t()},className:"text-gray-500 bg-white hover:bg-red-100 focus:ring-4 focus:ring-gray-300 rounded-lg border border-gray-200 text-sm font-semibold px-5 py-2.5 hover:text-gray-900 focus:outline-none focus:z-10",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"text-white   bg-blue-500 hover:bg-blue-100 focus:ring-4 focus:ring-blue-300 rounded-lg border border-blue-200 text-sm font-semibold px-5 py-2.5 hover:text-blue-900 focus:outline-none focus:z-10",children:"Crear Mantención"})]})]})]})};W.propTypes={onClose:M.func.isRequired,showModal:M.bool.isRequired,deptoId:M.number};const J="https://fastapi-gv342xsbja-tl.a.run.app/crear_departamento",Y=async t=>{const c={name:t.nombre,description:t.descripcion,baths:t.banos,rooms:t.habitaciones,beds:t.camas,dept_type:t.tipo,daily_rate:t.tarifa,address:t.direccion,address_number:t.numeroDireccion,active:t.active?"S":"N",commune_id:t.comuna,num_host:t.huespedes},x=new URLSearchParams(c).toString(),m=`${J}?${x}`,n={method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${t.access_token}`}};try{const l=await fetch(m,n);if(!l.ok){const s=await l.text();throw new Error(`API Error (${l.status}): ${s}`)}return await l.json()}catch(l){throw new Error("API Error: "+l.message||"Error al crear el departamento")}},X=A({nombre:d().required("Nombre requerido").min(3,"Mín. 3 letras").max(50,"Máx. 50 letras"),numeroDireccion:N().required("Número requerido").min(3,"Mín. 3 dígitos").max(9999999,"Máx. dígitos"),region:d(),comuna:d(),tipo:d(),tarifa:d().required("La tarifa es requerido").matches(/^\$\d{1,3}(\.\d{3})*$/,"Formato de tarifa inválido").test("is-valid-number","La tarifa debe ser un número válido",t=>{const c=parseFloat(t.replace(/[^\d]/g,""));return!isNaN(c)&&c>0&&c<=999999999}),direccion:d().required("direccion requerida").min(2,"Mín. 3 letras").max(100,"Máx. 100 letras"),descripcion:d().required("Descripción requerida").min(10,"Mín. 10 letras").max(250,"Máx. 250 letras"),banos:N().required("Baños requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),habitaciones:N().required("Habitaciones requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(10,"Máx. 10"),camas:N().required("Camas requeridas").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(20,"Máx. 20"),huespedes:N().required("Huéspedes requeridos").positive("Debe ser positivo").integer("Debe ser entero").min(1,"Mín. 1").max(20,"Máx. 20"),active:P().required("Estado requerido")}),Q=({onClose:t,showModal:c})=>{const{user:x}=_(),[m,n]=v.useState(""),[l,s]=v.useState(""),[g,p]=v.useState([]),{register:u,handleSubmit:C,formState:{errors:a},getValues:i,setValue:E,reset:O}=R({resolver:z(X)}),b=async o=>{try{const j={access_token:x.access_token,nombre:o.nombre,descripcion:o.descripcion,banos:o.banos,habitaciones:o.habitaciones,camas:o.camas,tipo:o.tipo,tarifa:parseInt(o.tarifa.replace(/\$|\.|,/g,"")),direccion:o.direccion,numeroDireccion:o.numeroDireccion,region:o.region,comuna:parseInt(o.comuna),huespedes:o.huespedes,active:o.active};console.log(j),await Y(j),t(),O(),D.fire({icon:"success",title:"Departmaneto creado",text:"El departamento se ha creado con éxito",confirmButtonText:"Ok"})}catch(j){t(),D.fire({icon:"error",title:"Error al crear departamento",text:j,confirmButtonText:"Ok"})}},y=o=>{const j=S(o.target.value);E("tarifa",j)},f="https://fastapi-gv342xsbja-tl.a.run.app/regiones";v.useEffect(()=>{fetch(f,{method:"GET"}).then(j=>j.json()).then(j=>{p(j)}).catch(j=>console.log(j))},[f]);const k=o=>{const j=`https://fastapi-gv342xsbja-tl.a.run.app/comunas/${o}`;fetch(j,{method:"GET"}).then(h=>h.json()).then(h=>{s(h)}).catch(h=>console.log(h))},q=o=>{E("region",o),k(o)},T=o=>{E("comuna",o)};return e.jsxs(r.Dialog,{open:c,"aria-labelledby":"modalCrear",size:"xl",className:"max-w-full max-h-screen py-2  overflow-y-scroll",children:[e.jsxs(r.DialogHeader,{className:"border-b-2 border-gray-300 flex justify-between items-start p-5",children:[e.jsx("span",{className:"text-2xl tracking-tight font-extrabold text-gray-900",children:"Crear Propiedad"}),e.jsx(r.IconButton,{color:"blue-gray",size:"sm",variant:"text",onClick:t,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:C(b),children:[e.jsxs(r.DialogBody,{children:[e.jsx(r.Typography,{children:"Datos de la propiedad"}),e.jsxs("div",{className:"grid grid-cols-2  gap-6 my-12 border-b-4 pb-6 border-b-blue-200",children:[e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{type:"text",name:"nombre",color:"blue",label:"Nombre",size:"md",...u("nombre"),error:a.nombre?a.nombre.message:void 0,success:!a.nombre&&i("nombre"),max:50,min:3}),a.nombre&&e.jsx("div",{className:"absolute left-0   bg-red-500 text-white text-xs mt-1 rounded-lg  px-2",children:a.nombre.message})]}),e.jsxs("div",{className:"flex  justify-center items-center gap-11",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(r.Input,{color:"blue",label:"Enumeración",name:"numeroDireccion",size:"md",...u("numeroDireccion"),type:"number",error:a.numeroDireccion?a.numeroDireccion.message:void 0,success:!a.numeroDireccion&&i("numeroDireccion")}),a.numeroDireccion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.numeroDireccion.message})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs(r.Select,{color:"blue",label:"Tipo de Propiedad",size:"md",value:m,onChange:o=>{E("tipo",o),n(o)},error:a.tipo?a.tipo.message:void 0,success:!a.tipo&&i("tipo"),children:[e.jsx(r.Option,{value:"Departamento",children:"Departamento"}),e.jsx(r.Option,{value:"Casa",children:"Casa"})]}),a.tipo&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.tipo.message})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Select,{color:"blue",label:"Región",size:"md",error:a.region?a.region.message:void 0,success:!a.region&&i("region"),onChange:o=>{q(o)},children:g?g==null?void 0:g.map(o=>e.jsx(r.Option,{value:String(o.REGION_ID),children:o.NOMBRE_REGION},o.REGION_ID)):e.jsx(r.Option,{value:"0",children:"No hay región disponibles"})}),a.region&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.region.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Tarifa Diaria",size:"md",name:"tarifa",...u("tarifa"),onChange:y,error:a.tarifa?a.tarifa.message:void 0,success:!a.tarifa&&i("tarifa"),type:"text"}),a.tarifa&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.tarifa.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Select,{color:"blue",label:"Comuna",size:"md",error:a.comuna?a.comuna.message:void 0,success:!a.comuna&&i("comuna"),onChange:o=>{T(o)},children:l?l==null?void 0:l.map(o=>e.jsx(r.Option,{value:String(o.COMUNA_ID),children:o.NOMBRE_COMUNA},o.COMUNA_ID)):e.jsx(r.Option,{value:"0",children:"No hay comunas disponibles"})}),a.comuna&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.comuna.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Dirección",size:"md",name:"direccion",...u("direccion"),type:"text",max:50,min:3,error:a.direccion?a.direccion.message:void 0,success:!a.direccion&&i("direccion")}),a.direccion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.direccion.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Textarea,{color:"blue",label:"Descripción",size:"md",name:"descripcion",...u("descripcion"),max:250,min:10,type:"text",error:a.descripcion?a.descripcion.message:void 0,success:!a.descripcion&&i("descripcion")}),a.descripcion&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.descripcion.message})]}),e.jsxs("div",{className:"grid w-full grid-cols-1 md:grid-cols-2  gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 w-full h-full gap-2",children:[e.jsx("img",{src:"https://images.pexels.com/photos/2635835/pexels-photo-2635835.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"row-span-1  rounded-l-lg w-full h-full",alt:"prod1"}),e.jsx("img",{src:"https://images.pexels.com/photos/161124/abbaye-de-senanque-monastery-abbey-notre-dame-de-senanque-161124.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"prod2",className:" w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod3",className:"  rounded-l-lg w-full h-full"}),e.jsx("img",{src:"https://media.istockphoto.com/id/1165384568/es/foto/complejo-moderno-de-edificios-residenciales-en-europa.jpg?s=2048x2048&w=is&k=20&c=E9ddfbNLOJw0NKIaKF6180TLCPuC4Se00DoCzf2VwFA=",alt:"prod4",className:" w-full h-full"})]}),e.jsx("div",{className:"flex justify-center w-full h-full",children:e.jsx("img",{src:"https://images.pexels.com/photos/7129137/pexels-photo-7129137.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",className:"w-full  rounded-r-lg",alt:"prod5"})})]})]}),e.jsx(r.Typography,{variant:"h6",children:"Especificaciones del alojamiento"}),e.jsxs("div",{className:"grid grid-cols-4 my-2 gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Cantidad de Baños",size:"md",...u("banos"),type:"number",name:"banos",max:10,min:1,error:a.message?a.message.message:void 0,success:!a.message&&i("message")}),a.banos&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.banos.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{name:"habitaciones",color:"blue",label:"Cantidad de Habitaciones",size:"md",...u("habitaciones"),type:"number",max:10,min:1,error:a.habitaciones?a.habitaciones.message:void 0,success:!a.habitaciones&&i("habitaciones")}),a.habitaciones&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.habitaciones.message})]}),e.jsxs("div",{children:[e.jsx(r.Input,{name:"camas",color:"blue",label:"Cantidad de Camas",size:"md",...u("camas"),max:20,min:1,type:"number",error:a.camas?a.camas.message:void 0,success:!a.camas&&i("camas")}),a.camas&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.camas.message})]}),e.jsxs("div",{className:"relative",children:[e.jsx(r.Input,{color:"blue",label:"Cantidad de Huespedes",size:"md",max:20,min:1,...u("huespedes"),type:"number",name:"huespedes",error:a.huespedes?a.huespedes.message:void 0,success:!a.huespedes&&i("huespedes")}),a.huespedes&&e.jsx("div",{className:"absolute left-0  bg-red-500 text-white text-xs mt-1 rounded-lg px-2",children:a.huespedes.message})]})]}),e.jsx("div",{className:"flex items-center justify-center my-6 ",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx(r.Checkbox,{color:"blue",defaultChecked:!0,size:"sm",name:"active",...u("active"),error:a.active?a.active.message:void 0,success:!a.active&&i("active")}),"Habilitar departamento"]})})]}),e.jsx(r.DialogFooter,{className:"p-2 border-t-2 border-gray-100 gap-4",children:e.jsx("button",{type:"submit",className:"text-white   bg-blue-500 hover:bg-blue-100 focus:ring-4 focus:ring-blue-300 rounded-lg border border-blue-200 text-sm font-semibold px-5 py-2.5 hover:text-blue-900 focus:outline-none focus:z-10",children:"Crear departamento"})})]})]})};Q.propTypes={onClose:M.func.isRequired,showModal:M.bool.isRequired};export{Q as M,F as a,V as b,W as c,S as f};
