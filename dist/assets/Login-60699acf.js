import{R as m,P as u,a as n,u as N,b as v,j as e,N as l}from"./index-21aef9be.js";import{l as y}from"./iconoTurismoReal_logo-2c08bdb6.js";import{c as R}from"./image1-92b8dcab.js";import{c as L,a as x,u as O,o as E}from"./index.esm-89d4b198.js";import{w as S}from"./sweetalert2-react-content.es-4b029d04.js";import{S as C}from"./sweetalert2.all-3c97b21a.js";const I=r=>r===m.ADMIN?u.ADMIN_ROLE:r===m.COLLABORATOR?u.COLLABORATOR_ROLE:n.CLIENTE_ROL,_="https://fastapi-gv342xsbja-tl.a.run.app/token",A=L({username:x().required("El usuario es obligatorio").min(3,"El usuario debe tener al menos 3 caracteres").max(20,"El usuario debe tener como máximo 20 caracteres"),password:x().required("La contraseña es obligatoria").min(8,"La contraseña debe tener al menos 8 caracteres").max(20,"La contraseña debe tener como máximo 20 caracteres")}),U=()=>{const r=N(),{login:p}=v(),{register:i,handleSubmit:h,formState:{errors:o}}=O({resolver:E(A)}),a=S(C),f=async c=>{try{a.fire({title:e.jsx("p",{children:"Iniciando sesion"}),didOpen:()=>{a.showLoading()}});const s=new URLSearchParams;s.append("grant_type",""),s.append("username",c.username),s.append("password",c.password),s.append("scope",""),s.append("client_id",""),s.append("client_secret","");const t=await fetch(_,{method:"POST",headers:{Accept:"application/x-www-form-urlencoded","Content-Type":"application/x-www-form-urlencoded"},body:s});if(!t.ok){const j=await t.json();throw new Error(j.detail||"Error desconocido")}const{access_token:w,token_role:g}=await t.json(),d=g.toLowerCase();p({access_token:w,role:d});const b=I(d);r(b,{replace:!0}),a.close(),a.fire({icon:"success",title:"¡Bienvenido!",text:"¡Iniciaste sesion correctamente!"})}catch(s){let t="Algo salió mal!";s.message&&(t=s.message),setTimeout(()=>{a.close(),a.fire({icon:"error",title:"Oops...",text:t})},10)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row min-h-screen justify-center bg-gray-100",children:[e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center  select-none",children:e.jsxs("div",{className:"bg-white p-4 sm:p-10 py-6 sm:py-20 rounded-3xl border-1 border-white shadow-lg w-full sm:w-3/4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("img",{className:"w-24 h-24 rounded-full shadow-md",src:y,alt:"Avatar"}),e.jsx("h1",{className:"text-4xl font-semibold py-10 text-gray-900",children:"Portal de Turismo Real"}),e.jsx("p",{className:"font-medium text-2xl text-gray-500 mt-4",children:"Iniciar sesión"})]}),e.jsxs("form",{onSubmit:h(f),children:[e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"py-2",children:[e.jsx("label",{className:"text-lg font-medium",children:"Usuario"}),e.jsx("input",{className:"w-full border rounded-xl p-4 mt-1",placeholder:"Ingresa tu usuario",name:"username",autoComplete:"off",...i("username")}),o.username&&e.jsx("p",{className:"text-red-500",children:o.username.message})]}),e.jsxs("div",{className:"py-2",children:[e.jsx("label",{className:"text-lg font-medium",children:"Contraseña"}),e.jsx("input",{type:"password",autoComplete:"current-password",className:"w-full border rounded-xl p-4 mt-1",placeholder:"Ingresa tu Contraseña",name:"password",...i("password")}),o.password&&e.jsx("p",{className:"text-red-500",children:o.password.message})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx(l,{to:n.REGISTER,className:"font-medium text-base text-blue-900 hover:text-blue-400",children:"Crear Cuenta"}),e.jsx("span",{className:"font-medium text-base text-gray-900",children:" O "}),e.jsx(l,{to:n.RECOVER_PASSWORD,className:"font-medium text-base text-gray-900 hover:text-blue-700",children:"Olvidaste tu contraseña?"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:" w-full select-none rounded-lg bg-blue-500 py-3.5 px-7 text-center align-middle font-sans text-sm font-bold uppercase text-white shadow-md shadow-blue-500/20 transition-all hover:shadow-lg hover:shadow-blue-500/40 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none",children:"Ingresar al Portal"})})]}),e.jsx("div",{className:"mt-4 flex items-center justify-center",children:e.jsx(l,{to:n.HOME,className:"font-semibold text-base text-gray-900 hover:text-blue-700",children:"Volver al Inicio"})}),e.jsx("p",{className:"text-xs text-gray-600 text-center mt-8",children:"© 2023 Turismo Real"})]})}),e.jsx("div",{className:"hidden lg:flex h-auto w-full lg:w-1/2 bg-gray-200 select-none",children:e.jsx("img",{className:"w-full h-full object-cover object-center",src:R,alt:"Background"})})]})})};export{U as default};
